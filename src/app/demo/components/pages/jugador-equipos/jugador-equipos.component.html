<div class="grid">
  <div class="col-12">
    <p-toast></p-toast>
    <div class="card">
      <h4 class="font-bold">Jugadores Equipos</h4>
      <p>
        En este módulo podrás asignar <strong>Jugadores</strong> a cada
        <strong>Equipo</strong>
      </p>
      <div class="card p-fluid">
        <h5>Seleccione los datos necesarios:</h5>
        <div class="field pt-3">
          <span class="p-float-label">
            <p-dropdown
              [options]="eventos"
              [(ngModel)]="selectedEvento"
              placeholder="Escoger un Evento"
              inputId="evento-dropdown"
              [autoDisplayFirst]="false"
              [filter]="true"
              filterBy="nombre"
              (onChange)="onEventoChange()"
            >
              <ng-template let-ev pTemplate="selectedItem">
                <div
                  class="flex flex-column align-items-center md:flex-row gap-2"
                >
                  <img
                    [src]="
                      getEventoImg(ev) ||
                      '/assets/demo/images/image-placeholder.svg'
                    "
                    [alt]="ev.nombre"
                    width="60"
                    class="shadow-1"
                  />
                  <div
                    class="flex flex-column align-items-center gap-1 md:align-items-start"
                  >
                    <span>{{ ev.nombre }}</span>
                    <span>
                      {{ ev.fecha_inicio | date }} - {{ ev.fecha_fin | date }}
                    </span>
                  </div>
                </div>
              </ng-template>
              <ng-template let-ev pTemplate="item">
                <div
                  class="flex flex-column align-items-center md:flex-row gap-2"
                >
                  <img
                    [src]="
                      getEventoImg(ev) ||
                      '/assets/demo/images/image-placeholder.svg'
                    "
                    [alt]="ev.nombre"
                    width="60"
                    class="shadow-1"
                  />
                  <div
                    class="flex flex-column align-items-center gap-1 md:align-items-start"
                  >
                    <span>{{ ev.nombre }}</span>
                    <span>
                      {{ ev.fecha_inicio | date }} - {{ ev.fecha_fin | date }}
                    </span>
                  </div>
                </div>
              </ng-template>
              <ng-template pTemplate="empty">
                <ng-container *ngIf="!isEventosLoading; else eventosLoading">
                  <span>No hay Eventos para seleccionar</span>
                </ng-container>
              </ng-template>
              <ng-template #eventosLoading>
                <div class="flex align-items-center gap-2">
                  <i class="pi pi-spin pi-spinner text-lg"></i>
                  <span>Los Eventos están cargando...</span>
                </div>
              </ng-template>
            </p-dropdown>
            <label for="evento-dropdown">Evento</label>
          </span>
        </div>

        <div class="field pt-3">
          <span class="p-float-label">
            <p-dropdown
              [options]="eventoDisciplinas"
              [(ngModel)]="selectedEventoDisciplina"
              placeholder="Escoger una Disciplina"
              inputId="disciplina-dropdown"
              [autoDisplayFirst]="false"
              [filter]="true"
              filterBy="nombre_disciplina,nombre_configuracion"
              (onChange)="onEventoDisciplinaChange()"
              [disabled]="selectedEvento == null"
            >
              <ng-template let-ed pTemplate="selectedItem">
                <div>
                  {{ ed.nombre_disciplina }} -
                  {{ ed.nombre_configuracion }}
                </div>
              </ng-template>
              <ng-template let-ed pTemplate="item">
                <div>
                  {{ ed.nombre_disciplina }} -
                  {{ ed.nombre_configuracion }}
                </div>
              </ng-template>
              <ng-template pTemplate="empty">
                <ng-container
                  *ngIf="!isEventoDisciplinasLoading; else disciplinasLoading"
                >
                  <span>No hay Disciplinas para seleccionar</span>
                </ng-container>

                <ng-template #disciplinasLoading>
                  <div class="flex align-items-center gap-2">
                    <i class="pi pi-spin pi-spinner text-lg"></i>
                    <span>Las Disciplinas están cargando...</span>
                  </div>
                </ng-template>
              </ng-template>
            </p-dropdown>
            <label for="disciplina-dropdown">Disciplina y Configuración</label>
          </span>
        </div>

        <div class="field" *ngIf="selectedEventoDisciplina">
          <p-fieldset [toggleable]="true" [collapsed]="true">
            <ng-template pTemplate="header">
              <div class="flex align-items-center text-primary">
                <span class="pi pi-cog mr-2"></span>
                <span class="font-bold text-lg">
                  Detalles de la Configuración
                </span>
              </div>
            </ng-template>
            <ng-container
              *ngIf="!isConfiguracionLoading; else configuracionLoading"
            >
              <ng-container *ngIf="selectedConfiguracion as c">
                <div class="text-lg font-bold mb-3">{{ c.nombre }}</div>
                <div class="grid grid-nogutter row-gap-2">
                  <div class="col-12 md:col-6">
                    Número de grupos: <b>{{ c.numero_grupos }}</b>
                  </div>
                  <div class="col-12 md:col-6">
                    Número de equipos por grupo: <b>{{ c.numero_miembros }}</b>
                  </div>
                  <div class="col-12 md:col-6">
                    Tiempo de juego: <b>{{ c.minutos_juego }}min</b>
                  </div>
                  <div class="col-12 md:col-6">
                    Tiempo entre partidos:
                    <b>{{ c.minutos_entre_partidos }}min</b>
                  </div>
                  <div class="col-12 md:col-6">
                    Ida y vuelta: <b> {{ c.ida_y_vuelta ? "Si" : "No" }} </b>
                  </div>
                  <div class="col-12 md:col-6">
                    Tarjetas: <b> {{ c.tarjetas ? "Si" : "No" }} </b>
                  </div>
                </div>
                <div
                  class="mt-3"
                  *ngIf="c.nombre_organizador && c.apellido_organizador"
                >
                  <span class="font-bold">Propietario:</span>
                  <p>{{ c.nombre_organizador }} {{ c.apellido_organizador }}</p>
                </div>
                

                  <!-- <button
                    pButton
                  icon="pi pi-arrow-right"

                    class="p-button p-button-rounded p-button-info p-button-sm"
                    label="Agregar"
                    routerLink="/pages/equipos"
                    [state]=""
                  ></button> -->
                
              </ng-container>
            </ng-container>
            <ng-template #configuracionLoading>
              <div class="flex align-items-center gap-2">
                <i class="pi pi-spin pi-spinner text-lg"></i>
                <span>La Configuración está cargando...</span>
              </div>
            </ng-template>
          </p-fieldset>
        </div>

        <div class="field pt-3">
          <span class="p-float-label">
            <p-dropdown
              [options]="equipos"
              [(ngModel)]="selectedEquipo"
              placeholder="Escoger un Equipo"
              inputId="equipo-dropdown"
              [autoDisplayFirst]="false"
              [filter]="true"
              filterBy="nombre"
              (onChange)="onEquipoChange()"
              [disabled]="selectedEventoDisciplina == null"
            >
              <ng-template let-eq pTemplate="selectedItem">
                <div
                  class="flex flex-column align-items-center sm:flex-row gap-2"
                >
                  <img
                    [src]="
                      getEquipoLogo(eq) ||
                      '/assets/demo/images/image-placeholder.svg'
                    "
                    [alt]="eq.nombre"
                    width="60"
                    class="shadow-1"
                  />
                  <span>{{ eq.nombre }}</span>
                </div>
              </ng-template>
              <ng-template let-eq pTemplate="item">
                <div
                  class="flex flex-column align-items-center sm:flex-row gap-2"
                >
                  <img
                    [src]="
                      getEquipoLogo(eq) ||
                      '/assets/demo/images/image-placeholder.svg'
                    "
                    [alt]="eq.nombre"
                    width="60"
                    class="shadow-1"
                  />
                  <span>{{ eq.nombre }}</span>
                </div>
              </ng-template>
              <ng-template pTemplate="empty">
                <ng-container
                  *ngIf="!isEventoDisciplinasLoading; else equiposLoading"
                >
                  <div>No hay Equipos para seleccionar</div>
                  <div>Agrege equipos aqui</div>
                </ng-container>
                <ng-template #equiposLoading>
                  <div class="flex align-items-center gap-2">
                    <i class="pi pi-spin pi-spinner text-lg"></i>
                    <span>Los Equipos están cargando...</span>
                  </div>
                </ng-template>
              </ng-template>
            </p-dropdown>
            <label for="equipo-dropdown">Equipo</label>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
